<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#1F4D78;
	font-weight:normal;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Segoe UI",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:#1F4D78;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-style:italic;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Segoe UI",sans-serif;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72">

<div class=WordSection1>

<p class=MsoTitleCxSpFirst>MetaAutomation Sample 3</p>

<p class=MsoTitleCxSpLast>Installation and Tutorials</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoTocHeading>Contents</p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc516731861">Sample
Overview<span style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc516731862">Setup<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731863">A. Configure
Users and Machines<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731864">A1. Choose
machines or OS instances<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731865">A2. Login as
the target users on the target machines<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731866">A3. File
Sharing<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731867">A4. Install
Windows components<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731868">B. Configure
Eventing<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731869">B1. Create
the MetaAutomationService event listener on each machine<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731870">B2. Verify
Event Viewer<span style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731871">C. Create
Services<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731872">C1. Use IIS
Manager to create the necessary services and thread pools<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731873">C2. Open
ports as needed<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731874">D. Load and
Configure the Solution in Visual Studio<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731875">D1. Install
VS 2017<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731876">D2. Load
MetaAutomation Sample 3 solution<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731877">D5.
Configure post-build binary copies<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731878">D6. Edit the
project config files<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731879">D7. Create
the publish profiles for MetaAutomationService<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731880">D8. Build
the entire solution<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731881">D9. Deploy
MetaAutomationService to all the machines<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731882">E. Run
Example Check 1 (the default)<span style='color:windowtext;display:none;
text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731883">E1. Build<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731884">E2.
Configure the last-run check artifact to drive the next check run<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731885">Running the
other example checks<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731886">Example
check 2<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731887">Example
check 3<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731888">Example
check 4<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731889">Example
check 5<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731890">Example
check 6<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731891">Iterative
Runs for Test and Debugging<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731892">Outputs from
a Successful Run<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731893">Using the
Artifact XML to Drive Checks and Read Results<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731894">A. Entries
in the XML artifact that drive the check<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc516731895">B. Entries
that are determined by the check code and the engine during a check run<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc516731896">Troubleshooting<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<span style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<h1><a name="_Toc516731861">Sample Overview</a></h1>

<p class=MsoNormal>The MetaAutomation Sample 3 is a Visual Studio solution
developed with Microsoft Visual Studio Community 2017. It contains 9 projects
and several folders of important files.</p>

<p class=MsoNormal>Microsoft Visual Studio Community 2017 is free to download,
use and install from <span class=MsoHyperlink><a
href="https://www.visualstudio.com/downloads/">https://www.visualstudio.com/downloads/</a></span>
. </p>

<p class=MsoNormal>The sample is mostly platform-independent; to run the C#
code on another platform that is supported by the Mono project for example,
remove the Windows Eventing or port the eventing manually to the other
platform, and substitute a different XML-based service for Windows
Communication Foundation (WCF).</p>

<p class=MsoNormal>This document concerns setup and run of the sample as
downloaded, including the 6 example checks included in the sample. </p>

<p class=MsoNormal>MetaAutomation samples 1, 2 and 3 demonstrate</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Self-documenting, hierarchical check steps that show pass, fail,
or blocked for each check step</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Timeouts for each check step that are configurable in each check
artifact used to run the next one</p>

<p class=MsoNormal>Both MetaAutomation Sample 2 and MetaAutomation Sample 3
demonstrate checks with</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>distribution across processes with synchronization within each
check</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>running any number of checks in parallel</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>pure, compact, descriptive check artifacts in a schema-defined
grammar of XML</p>

<p class=MsoNormal>MetaAutomation Sample 3 also demonstrates the scale
potential and cross-machine or cross-tier quality-measurement power of
MetaAutomation for e.g. measuring quality for an Internet of Things project, by</p>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:
Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>using any number (1-N) of machines and configurable users as
defined to run the checks</p>

<p class=MsoNormal>But, installing and configuring MetaAutomation Sample 3 is
much more complex than MetaAutomation Sample 1 or MetaAutomation Sample 2;
users and filesystem directories must be installed on each machine, a simple
XML-based service must be installed and configured on each target machine, and
the build must be configured to place binaries in the correct locations and
machines.</p>

<p class=MsoNormal>Learning to work with MetaAutomation Sample 1 first, and
then MetaAutomation Sample 2, is recommended as a prerequisite for
MetaAutomation Sample 3, because the earlier samples are much simpler to setup
and run and all the concepts introduced with the earlier samples are also
present in the later ones. Start with MetaAutomation Sample 1, and the tutorial
that comes with it.</p>

<p class=MsoNormal>For more information and diagrams on how this system works,
to customize the checks or adapt the infrastructure, and more on how this
implements the Atomic Check pattern and works in the bigger setting of the
MetaAutomation pattern language, please see the site <span class=MsoHyperlink><a
href="http://MetaAutomation.net">http://MetaAutomation.net</a></span> and the
book on MetaAutomation (3<sup>rd</sup> Edition). In the 3<sup>rd</sup> Edition
of the book on MetaAutomation, A figure in the section on Sample 3 shows how
MetaAutomation Sample 3 communicates across multiple tiers.</p>

<h1><a name="_Toc516731862">Setup</a></h1>

<p class=MsoNormal>The setup steps are organized with numbers to represent the
sections, and numbers to enumerate the steps. Unless there’s a clear reason not
to (e.g., you have Visual Studio installed already, or you are working on a
non-Windows platform) it’s easiest to follow the steps in order.</p>

<h2><a name="_Toc516731863">A. Configure Users and Machines</a></h2>

<h3><a name="_Toc516731864">A1. Choose machines or OS instances</a> </h3>

<p class=MsoNormal>Choose the machines or OS instances you wish to use,
including the master machine that will run the primary solution, and target
machines to do the check runs. Keep a complete list of these machines because
they will be used in some of the following configuration steps.</p>

<p class=MsoNormal>The following instructions assume that you are working in
the Windows 10 Pro environment. The instructions were verified on June 12<sup>th</sup>
2018, on Windows 10 Pro version 1803.</p>

<h3><a name="_Toc516731865">A2. Login as the target users on the target
machines</a></h3>

<p class=MsoNormal>Login as the target users on the target machines, to
initialize the file system for the users and verify access. This might only be
necessary on client operating systems e.g. Windows 10, and this step could be
automated with e.g. PowerShell.</p>

<p class=MsoNormal>For each user on each machine, create a file directory</p>

<p class=MsoNormal><span style='font-family:"Courier New"'>C:\Users\&lt;user&gt;\Documents\Checks</span></p>

<p class=MsoNormal>To hold the binaries that run the checks or check
components.</p>

<p class=MsoNormal>It is much easier if (by default) the same test-specific
user is engaged on each machine. That way, authentication between the machines
is not an issue.</p>

<h3><a name="_Toc516731866">A3. File Sharing</a></h3>

<h4>For the check execution files</h4>

<p class=MsoNormal>For each such directory “Checks” created in the last step,
share it with read/write permissions to the primary user(s) that will be
building and deploying solution components from Visual Studio. The other permissions
will work with defaults.</p>

<p class=MsoNormal>For each target machine or tier in the last step, configure
“Advanced Sharing Settings” to turn on “network discovery” and turn on “file
and printer sharing.”</p>

<p class=MsoNormal>From each machine or tier that is involved with the check runs
(i.e. both the master machine and the target machine or machines), connect to
the file shares on the other machines and enter credentials as needed. Click
the check box for “Remember my credentials.” (Note: for many machines, do this
with PowerShell; for those who use PowerShell, this might be much easier.)</p>

<h4>For the MetaAutomationService service files</h4>

<p class=MsoNormal>On each target machine or tier that is involved with the
check runs, create a new directory:</p>

<p class=MsoNormal><span style='font-family:"Courier New"'>C:\inetpub\wwwroot\MetaAutomationService</span> 
</p>

<p class=MsoNormal>Turn on sharing for the MetaAutomationService directory.</p>

<p class=MsoNormal>Using advanced sharing, add “Full Control” permissions for
the custom user(s) of step A2 above to the MetaAutomationService directory.</p>

<p class=MsoNormal>If using anonymous access for HTTP services in a network for
these services, share the directory out to everyone with read permissions.</p>

<h3><a name="_Toc516731867">A4. Install Windows components</a></h3>

<p class=MsoNormal>On each target and on the master machine, In the Control
Panel, start the configuration tool “Programs and Features” and pick tab “Turn
Windows features on or off.”</p>

<p class=MsoNormal>Check boxes to enable the following features:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.NET
Framework 4.7 Advanced Services -&gt; ASP.NET 4.7</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.NET
Framework 4.7 Advanced Services -&gt; WCF Services -&gt; HTTP Activation</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; FTP Server -&gt; FTP Service</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; Web Management Tools -&gt; IIS Management Console</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; Web Management Tools -&gt; IIS Management Scripts
and Tools</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; Web Management Tools -&gt; IIS Management Service</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; World Wide Web Services -&gt; Application
Development Features -&gt; .NET Extensibility 4.7</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; World Wide Web Services -&gt; Application
Development Features -&gt; ASP.NET 4.7</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Internet
Information Services -&gt; World Wide Web Services -&gt; Application
Development Features -&gt; ISAPI Extensions</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Application Development Features
-&gt; ISAPI Filters</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Common HTTP Features -&gt; Default
Document</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>12.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Common HTTP Features -&gt; HTTP
Errors</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>13.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Health and Diagnostics -&gt; HTTP
Logging</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>14.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Health and Diagnostics -&gt;
Logging Tools</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>15.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Health and Diagnostics -&gt;
Request Monitor</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>16.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Security -&gt; Request Filtering</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>17.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Internet Information
Services -&gt; World Wide Web Services -&gt; Security -&gt; Windows
Authentication</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>18.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Windows PowerShell 2.0
-&gt; Windows PowerShell 2.0 Engine</p>

<p class=MsoNormal>Click OK to save changes.</p>

<p class=MsoNormal>These configuration steps can also be automated with
PowerShell.</p>

<h2><a name="_Toc516731868">B. Configure Eventing</a></h2>

<h3><a name="_Toc516731869">B1. Create the MetaAutomationService event listener
on each machine</a></h3>

<p class=MsoNormal>On the master machine and on each target machine, run a
PowerShell shell as admin, and run this script in the shell:</p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:107%;font-family:
"Courier New"'>[system.Diagnostics.EventLog]::CreateEventSource(&quot;MetaAutomationService&quot;,
&quot;MetaAutomationService&quot;)</span></p>

<p class=MsoNormal>Debug builds of MetaAutomation use the Windows Event log for
improved visibility into what it’s doing, e.g. with errors and XML
communications. This is a very important tool to use in case of configuration
difficulty.</p>

<h3><a name="_Toc516731870">B2. Verify Event Viewer</a></h3>

<p class=MsoNormal>Run Event Viewer and look at the hierarchy:</p>

<p class=MsoNormal>Event Viewer (local) -&gt; Applications and Services Logs</p>

<p class=MsoNormal>Ensure that the MetaAutomationService event listener is
created on each machine in the “Applications and Services Logs” group.</p>

<p class=MsoNormal>In this event listener, events are shown for the master and
target machines communicating with each other with valid XML documents to carry
the detailed instructions needed to run the various check components. This is a
very useful tool to see what’s going on, e.g., if something in the system is
not behaving as expected.</p>

<h2><a name="_Toc516731871">C. Create Services</a></h2>

<h3><a name="_Toc516731872">C1. Use IIS Manager to create the necessary
services and thread pools</a></h3>

<p class=MsoNormal>On each machine, as an admin user, start Internet
Information Services (IIS) Manager.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Find
and launch the IIS Manager </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Create
the MetaAutomationService site</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>On
the left, open up the server node with the machine name to show the “Sites”
folder</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
there is a “Default web Site,” right-click on it and remove the default site</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
on the “Sites” folder icon and select “add website…”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Name
the Site “MetaAutomationService”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Pick
a port number if needed to avoid collisions with existing sites, OR remove the
existing sites. For port 80, for example, there might be a collision with the
default site; you can use port 80, but the existing default site (that also
uses port 80) must be removed. Note the port number because it will be needed
for later configuration steps.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>f.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Set the directory created in step A2 above as the path</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>g.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Set
the host name as the machine name</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>h.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OK
to save settings</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span> (For
anonymous authentication, as the sample is coded) In IIS Authentication, enable
Anonymous Authentication for the service</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the “Sites” node at left</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Double-click
on the MetaAutomationService site to show “Home” controls for the service</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the node for IIS -&gt; Authentication…</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
the row for “Anonymous Authentication” and click “Enable” at right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
the row for “ASP.NET Impersonation” and click “Disable” at right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>f.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Right-click the row for “Forms Authentication” and click “Disable” at
right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>g.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
the row for “Windows Authentication” and click “Disable” at right</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(Optional,
if Windows authentication is added to the solution) In IIS Authentication,
enable Windows Authentication for the service</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the “Sites” node at left</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Double-click
on the MetaAutomationService site to show “Home” controls for the service</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the node for IIS -&gt; Authentication…</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
the row for “Anonymous Authentication” and click “Disable” at right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
the row for “ASP.NET Impersonation” and click “Enable” at right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>f.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Right-click the row for “Forms Authentication” and click “Disable” at
right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>g.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right-click
the row for “Windows Authentication” and click “Enable” at right</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
on MetaAutomationService again, to show the “Home” controls</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Increase
the log frequency</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Double-click
to open the IIS Logging tool</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Under
“Log File rollover,” set Schedule to “Hourly.”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Based
on your team situation using the MetaAutomation sample, consider clicking the
“Use local time for file naming and rollover” check box.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
“Apply” at right</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Set
the application pool to run as the identity to launch CheckProcess.exe (which
runs the check, or a portion of it)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
the root node at upper left, to show the node “Application Pools”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
“Application Pools” to list the pools</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
“MetaAutomationService” pool</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
“Advanced Settings…” under “Actions” at right</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
the “Identity” row in the Advanced Settings window</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>f.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Click the ellipsis (“…”) by the user identity, in the “Identity” row</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>g.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
the “Custom account” radio button.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>h.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Enter
a custom user identity account. This could be the same user account as step A2
above.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>i.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Enter a password for the account</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>j.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Click “OK” to close and save</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'>k.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
“OK” to close the “Advanced Settings” dialog</p>

<h3>&nbsp;</h3>

<h3><a name="_Toc516731873">C2. Open ports as needed</a></h3>

<p class=MsoNormal>Use a Windows Firewall tool to enable inbound rules to open
ports as needed for incoming HTTP requests to the services on each machine. If
using port 80, it might not be necessary to make any changes, but check anyway
and enable the appropriate port.</p>

<p class=MsoNormal>An easy way to do this: start “Allow an app through Windows
Firewall,” clich “Change settings,” and verify that “World Wide Web Services
(HTTP)” is enabled for domain and private networks but NOT public networks.</p>

<h2><a name="_Toc516731874">D. Load and Configure the Solution in Visual Studio</a></h2>

<h3><a name="_Toc516731875">D1. Install VS 2017</a></h3>

<p class=MsoNormal><a name="_Hlk516740579">If you do not have a version of
Visual Studio 2017, install the latest free version:</a></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Browse
to this page <a href="https://www.visualstudio.com/downloads/">https://www.visualstudio.com/downloads/</a></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
the download for “Visual Studio Community 2017” or a newer version</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Verify
that it is published by Microsoft, and Select “Run”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Depending
on choices in the installer, choose the “Typical” installation, or select these
components:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.Net
core cross-platform</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Visual
Studio extension development</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.Net
desktop development</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Proceed
with the installation</p>

<h3><a name="_Toc516731876">D2. Load MetaAutomation Sample 3 solution</a></h3>

<p class=MsoNormal>The MetaAutomation Sample 3 is on GitHub as a zipfile, but
the easiest way to find it is from the Samples tab on the MetaAutomation web
site:</p>

<p class=MsoNormal><span class=MsoHyperlink><a href="http://metaautomation.net">http://metaautomation.net</a></span></p>

<p class=MsoNormal>Click the “Samples” tab, download the solution and
un-compress it to the file system in your workspace, for example, a
subdirectory of the Documents directory created for the solution. Ensure that
there are no spaces in the absolute workspace path, because that can confuse
the post-build file copy steps that are included in some of the projects in the
MetaAutomation Sample 3 solution.</p>

<p class=MsoNormal>Load the MetaAutomationSample3 solution in Visual Studio;
all 9 projects should load correctly.</p>

<p class=MsoNormal>Build the entire solution. If there is a missing assembly,
re-build the entire solution, until the only remaining errors are post-build
copy commands.</p>

<h3><a name="_Toc516731877">D5. Configure post-build binary copies</a></h3>

<p class=MsoNormal>Post-build binary copies are needed for the CheckProcess
process running on each machine and for each user. For each project that needs
post-build files copied, edit the project properties with Build Events -&gt;
Post-build event command line window.</p>

<p class=MsoNormal>The project binaries must be copied for the local (master)
machine and each target machine and for each user’s file system. By convention,
the file copy target location for the machine and user is:</p>

<p class=MsoNormal><span class=MsoHyperlink><span style='font-size:9.0pt;
line-height:107%;font-family:"Courier New";text-decoration:none'>\\&lt;TARGETMACHINE&gt;\Users\&lt;USERNAME&gt;\Documents\Checks</span></span></p>

<p class=MsoNormal>Although this might also be shared on the network as</p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:107%;font-family:
"Courier New"'>\\&lt;TARGETMACHINE&gt;\Checks</span></p>

<p class=MsoNormal>For the MetaAutomationBaseMtLibrary project, copy the target
DLL (and the corresponding PDB, for debug information).</p>

<p class=MsoNormal>For the MetaAutomationClientMtLibrary, copy the target DLL
(and the corresponding PDB, for debug information).</p>

<p class=MsoNormal>For the MetaAutomationClientMt, copy the target DLL (and the
corresponding PDB, for debug information).</p>

<p class=MsoNormal>For the CheckMethods project, copy the target DLL (and the
corresponding PDB, for debug information).</p>

<p class=MsoNormal>For the CheckProcess project, copy the target
CheckProcess.EXE and the corresponding config file (and the corresponding PDB,
for debug information).</p>

<p class=MsoNormal>Build the entire solution to test the file copy settings,
and make corrections as needed.</p>

<p class=MsoNormal>Check these things to verify success:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
build-all succeeds with zero errors or warnings</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Each
target machine has the target files copied in the correct directory</p>

<h3><a name="_Toc516731878">D6. Edit the project config files</a></h3>

<p class=MsoNormal>So the different components can talk to each other, the
web.config file must be edited for the MetaAutomationService, and the
App.config files for the CheckProcess project and the CheckLauncher project.
For each of these three .config files, in the xml path /Configuration/system.serviceModel/client/,
there must be an “endpoint” element for each target machine with the following
XML attributes:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Address
of the service, depending on how the services were configured in step C1 above,
e.g. <span style='font-size:9.5pt;line-height:107%;font-family:Consolas;
color:red;background:white'>address</span><span style='font-size:9.5pt;
line-height:107%;font-family:Consolas;color:blue;background:white'>=</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span><span class=MsoHyperlink><span style='font-size:
9.5pt;line-height:107%;font-family:Consolas;background:white'><a
href="http://MACHINENAME:62978/MetaAutomationService.svc">http://MACHINENAME:62978/MetaAutomationService.svc</a></span></span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Binding
of the endpoint: <span style='font-size:9.5pt;line-height:107%;font-family:
Consolas;color:red;background:white'>binding</span><span style='font-size:9.5pt;
line-height:107%;font-family:Consolas;color:blue;background:white'>=</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span><span style='font-size:9.5pt;line-height:107%;
font-family:Consolas;color:blue;background:white'>basicHttpBinding</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Binding
configuration: <span style='font-size:9.5pt;line-height:107%;font-family:Consolas;
color:red;background:white'>bindingConfiguration</span><span style='font-size:
9.5pt;line-height:107%;font-family:Consolas;color:blue;background:white'>=</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span><span style='font-size:9.5pt;line-height:107%;
font-family:Consolas;color:blue;background:white'>BasicHttpBinding_IMetaAutomationService</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Contract:
<span style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:red;
background:white'>contract</span><span style='font-size:9.5pt;line-height:107%;
font-family:Consolas;color:blue;background:white'>=</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span><span style='font-size:9.5pt;line-height:107%;
font-family:Consolas;color:blue;background:white'>IMetaAutomationService</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:black;
background:white'>&quot;</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Name
of the endpoint. The name of the endpoint must be identical to the machine or
OS instance name, but in all UPPER-CASE CHARACTERS.</p>

<h3><a name="_Toc516731879">D7. Create the publish profiles for
MetaAutomationService</a></h3>

<p class=MsoNormal>In Visual Studio, for the MetaAutomation Sample 3 solution,
edit or create a publish profile for the master (local) machine and every
target machine.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
Solution Explorer view, right-click over the project MetaAutomationService and
select “Publish…” to open the Publish windows</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
the “Pick a publish target” dialog, click the “IIS, FTP, etc” tab</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
the “Publish” droplist and select “Create profile”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Choose
publish method “File System”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add
the target location: <span class=MsoHyperlink>\\&lt;servername&gt;\MetaAutomationService</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
Next</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
“Debug” configuration</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Under
“File Publish Options”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Check
“Delete all existing files prior to publish.”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Check
“Precompile during publishing.”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Save
to save the profile</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Drop the “Actions”
link and select “Rename profile”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Give the profile a
name to represent the target machine</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>12.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Save the profile name</p>

<p class=MsoNormal>When you’re done, you will have profiles for the master
machine and each of the target machines.</p>

<h3><a name="_Toc516731880">D8. Build the entire solution</a></h3>

<h3><a name="_Toc516731881">D9. Deploy MetaAutomationService to all the
machines</a></h3>

<p class=MsoNormal>Right-click on the MetaAutomationService project in the
Solution Explorer of Visual Studio, choose “Publish…” and select the publishing
profile for your target machine. The output of the publish operation should
include “Publish: 1 succeeded, …”</p>

<p class=MsoNormal>Publish to each of the machines in turn, including the
current (master) machine and the target machines.</p>

<h2><a name="_Toc516731882">E. Run Example Check 1 (the default)</a></h2>

<h3><a name="_Toc516731883">E1. Build</a></h3>

<p class=MsoNormal>Do a complete build first, to ensure that all 9 projects in
the solution are built, the binaries distributed to the various machines, and
the service successfully deployed to the master machine and all target
machines..</p>

<h3><a name="_Toc516731884">E2. Configure the last-run check artifact to drive
the next check run</a></h3>

<p class=MsoNormal>In Visual Studio, in the Solution Explorer window for
solution MetaAutomation Sample 3, right-click on the solution and select “Open
Folder in File Explorer.”</p>

<p class=MsoNormal>Find the Artifacts folder in the same window, and inside it,
the file CheckMap.xml. Open the file to view and edit. This is the CheckMap
that points to the current artifact file for any check; this is important
because the current artifact file for any check also has the information
required to run the check next time. See the below table for more details on
this point.</p>

<p class=MsoNormal>As downloaded, the sample solution has only one example
check enabled, the example 1. In this element “Check,” find the named values
for “DirectoryName” and “CurrentCheckRunArtifact.”</p>

<p class=MsoNormal>In the File Explorer window, drill down through the
“Artifacts” folder and then the folder of the “DirectoryName” of the enabled
example check. This should be “Example_1_SimpleOneTierCheck.” In that folder,
find the file with the name that is the “CurrentCheckRunArtifact.” It’s
expected to be the file “CheckRunArtifact_Original.xml” in case the example
check has not yet run to completion.</p>

<p class=MsoNormal>Open the artifact file in your favorite text editor, e.g.,
Visual Studio. Changes might be necessary for the following child elements of element
“CheckRunData.”</p>

<p class=MsoNormal>An easy approach to editing the artifact files: edit every
value with “EDIT_” (case-sensitive) in the string.</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><b><span style='font-size:9.0pt'>In the
  DataElement element with Name attribute of this value…</span></b></p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><b><span style='font-size:9.0pt'>Set
  the Value attribute to this</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>PathAndFileToRunner</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Edit this value. On the target machine (destination machine, where
  the check will be executed) this is the absolute path to the location of
  CheckProcess.exe. Depending on where the exe is placed in post-build steps
  and the user, this value might need to be changed.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>OriginMachine</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Edit this value to be the current machine name or OS instance name,
  IN ALL CAPS.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>DestinationMachine</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Edit this value to be the machine on which the check will be
  executed, or in the case of a multi-tier check, the least dependent part of
  the check, IN ALL CAPS.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>CheckClientUser</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Edit this value to be the current user that launches the check with
  CheckLauncher.exe. This may be the same user as above in step A2.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>CheckMethodName</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>The value probably does not need to be changed.</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>The name of the method that is executed in CheckMethods.dll. See the
  CheckMethods project in Solution Explorer, and open the source file for the
  example check, to find this method.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>CheckMethodGuid</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>The value probably does not need to be changed.</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>The GUID of the method, as specified with the CheckMethodAttribute
  instance for the method.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>ThreadPoolUserName</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Edit this value to be the user name of the identity that executes the
  MetaAutomationService through the threadpool. This may be the same user as
  above in step A2.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>CheckTimeOutMilliseconds</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>The value probably does not need to be changed.</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Timeout for the entire check. For the default example check, 10000 ms
  is probably enough.</p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>CheckLibraryAssembly</p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>The value probably does not need to be changed.</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>This specifies the assembly to load to look for the check to execute.
  </p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Verify and edit as needed, save changes, and hit F5 to run
in a debug session.</p>

<p class=MsoNormal>The sample implementation opens a command-line window to
show the output of running the check or checks specified in the check map file
CheckMap.xml.</p>

<p class=MsoNormal>The artifacts of the check run(s) are new versions of the
check run artifact file(s). The file CheckMap.xml is updated at check run
completion(s) to point to the new versions of the artifact file(s). To see results
of the runs, open the new artifact files. Optionally, put the XSL file in the
“ReferenceDocuments” folder, called CheckRunArtifact.XSL, in the same folder as
the artifact file, then open it in a standard web browser to see a simple
human-friendly presentation of the data of the artifact.</p>

<p class=MsoNormal>The check that is enabled by default does a minimal
demonstration of self-documenting, hierarchical check steps.</p>

<h2><a name="_Toc516731885">Running the other example checks</a></h2>

<p class=MsoNormal>This example check is enabled by default. To disable it,
comment out the “Check” element in XML in the map file that represents this
check.</p>

<p class=MsoNormal>Each un-commented “Check” element in the map file is
enabled, and will run a different example check. All the enabled example checks
will run in parallel in different processes on target (destination) machines on
launch of the CheckLauncher executable.</p>

<h3><a name="_Toc516731886"></a><a name="_Toc438121085">Example check 2</a></h3>

<p class=MsoNormal>Un-comment the “Check” element in the map file for <span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue;
background:white'>Example_2_CheckOfWebPageBuiltToFailRandomly</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue'> </span>to
enable this check, and refer to the above table to configure the last-run artifact
file (or, the original) as needed.</p>

<p class=MsoNormal>This check requests a page of the MetaAutomation.net web
site, but the page is deliberately built to fail 80% of the time. There are 5
possible behaviors of this page, based on the time of page request. Only one
behavior passes the check, and the others fail, to demonstrate how a check can
report the failure.</p>

<h3><a name="_Toc516731887"></a><a name="_Toc438121086">Example check 3</a></h3>

<p class=MsoNormal>Un-comment the “Check” element in the map file for <span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue;
background:white'>Example_3_TwoTierCheckOfFileSystem</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue'> </span>to
enable this check, and refer to the above table to configure the last-run
artifact file as needed.</p>

<p class=MsoNormal>For this check, there are two more steps needed: </p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Configure
the file share used</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Configure
the second target machine</p>

<p class=MsoNormal>In the last-run (or original) artifact file, see the element
“CheckCustomData,” and child element DataElement with name
“TestFileNameAndPath.” Edit this value to point to the file share to use.</p>

<p class=MsoNormal>See the name “DestinationMachine” and notice that it occurs
twice for this check: once in a child element of “CheckRunData” element, and
once in a child element of the “SubCheckData” element. The first name/value
pair designates where the less dependent part of this check runs, and the
second designates where the more dependent part of this check (or, “sub-check”)
runs. The two locations here can be the same machine or different machines.</p>

<p class=MsoNormal>If the two machines for the two parts of the check are the
same as each other (whether or not they are the same as the machine that runs
CheckLauncher.exe) the file share could be, e.g., “C:\temp\TestFile.txt.” The
directory needs to exist before check run, but the file does not need to exist
before the run.</p>

<p class=MsoNormal>If the two machines for the two parts of the check are
different, then the “TestFileNameAndPath” needs to point to a file share that
is accessible by the same path from both places.</p>

<p class=MsoNormal>This check demonstrates a minimal behavioral check that
requires driving check steps in two different operating system processes,
tiers, machines or OS instances.</p>

<h3><a name="_Toc516731888"></a><a name="_Toc438121087">Example check 4</a></h3>

<p class=MsoNormal>Un-comment the “Check” element in the map file for <span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue;
background:white'>Example_4_DeeplyNestedCrossProcessCheck</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue'> </span>to
enable this check. Before running it, update the artifact files by editing
every value with “EDIT_” in the string.</p>

<p class=MsoNormal>This check demonstrates how a check can have an arbitrarily
complex hierarchical structure of check steps across an arbitrarily complex set
of operating system processes. MetaAutomation Sample 3 demonstrates (using a
platform-dependent WCF service) that these processes can happen across any
number of systems, given that each of these systems can run a simple platform-independent
XML-based service.</p>

<h3><a name="_Toc516731889"></a><a name="_Toc438121088">Example check 5</a></h3>

<p class=MsoNormal>Un-comment the “Check” element in the map file for <span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue;
background:white'>Example_5_StaticFailureIndicatedInArtifact_DebugBuildOnly</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue'> </span>to
enable this check.</p>

<p class=MsoNormal>This check will only work with a DEBUG build of the
MetaAutomation sample system. It demonstrates a hard-coded failure in a check
to aid with debugging and demonstrate how failures are handled in multi-tiered
checks.</p>

<h3><a name="_Toc516731890"></a><a name="_Toc438121089">Example check 6</a></h3>

<p class=MsoNormal>Un-comment the “Check” element in the map file for <span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue;
background:white'>Example_6_RollingFailureIndicatedInArtifact_DebugBuildOnly</span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue'> </span>to
enable this check.</p>

<p class=MsoNormal>This check will only work with a DEBUG build of the
MetaAutomation sample system. It demonstrates rolling failures in a check to
aid with debugging, and failure handing in a multi-tiered check.</p>

<h2><a name="_Toc516731891"></a><a name="_Toc438121090">Iterative Runs for Test
and Debugging</a></h2>

<p class=MsoNormal>In the CheckLauncher project, class
LaunchAsynchronousChecks, see the local variable</p>

<p class=MsoNormal><span style='font-size:9.5pt;line-height:107%;font-family:
Consolas;color:blue;background:white'>const</span><span style='font-size:9.5pt;
line-height:107%;font-family:Consolas;color:black;background:white'> </span><span
style='font-size:9.5pt;line-height:107%;font-family:Consolas;color:blue;
background:white'>int</span><span style='font-size:9.5pt;line-height:107%;
font-family:Consolas;color:black;background:white'> IterateCount = 1;</span></p>

<p class=MsoNormal>This determines how many times the checks referenced in the
file CheckMap.xml are run. This can be set to any number and is useful to set
to a higher number for repeated runs of the Debug rolling failures example
check.</p>

<h3><a name="_Toc516731892"></a><a name="_Toc438121091">Outputs from a
Successful Run</a></h3>

<p class=MsoNormal>Look in the directory where you edited the file
CheckRunArtifact_Original.xml. There is now a new file called
CheckRunArtifact_&lt;GUID&gt;.xml. Open up this file to see the result of the
run.</p>

<p class=MsoNormal>The file CheckMap.xml now points to this file, and doesn’t
know about the CheckRunArtifact.Original.xml. To make changes to the check run,
edit the new file; it is the new reference for running the check.</p>

<h3><a name="_Toc516731893">Using the Artifact XML to Drive Checks and Read
Results</a></h3>

<p class=MsoNormal>Here is the form of the XML artifact from example check 3
from MetaAutomation Sample 3, which shows a basic file system check spanning up
to three tiers, machines or OS instances, one for launching the check, one for
creating and writing a file, and one for reading and verifying the file. The
text in various shades of red and blue are as seen in the Visual Studio text
editor, with default colorization settings, and the green annotations are added
to this graphic to correspond to the notes below:</p>

<p class=MsoNormal><img border=0 width=422 height=272 id="Picture 1"
src="files/image001.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<h3><a name="_Toc516731894">A. Entries in the XML artifact that drive the check</a></h3>

<p class=MsoNormal>For this sample implementation, these values are set by
editing the XML with a text editor, if they need to be set or changed.</p>

<p class=MsoNormal>For an adapted or more complete implementation of the
patterns of MetaAutomation, these values might be set by the automation
infrastructure outside of the scope of the actual check runs.</p>

<h4>A1. PathAndFileToRunner</h4>

<p class=MsoNormal>A relative path is used here, and is determined by the name
of the EXE used to establish the new process for running a check or subcheck.</p>

<h4>A2. DestinationMachine</h4>

<h4>A3. CheckMethodGuid</h4>

<p class=MsoNormal>This GUID determines the method in the CheckMethods assembly
that is executed to begin the check. In C# code, the GUID is set with the
CheckMethodAttribute class of the MetaAutomationClientSpLibrary.</p>

<h4>A4. ThreadPoolUserName</h4>

<h4>A5. SemaphoreTimeoutMilliseconds</h4>

<p class=MsoNormal>Global operating system semaphores are used to synchronize
checks with subchecks, and these have timeouts defined. If a semaphore times
out, the check might end with no artifact record of the check run, so judicious
use of the check step timeouts is recommended. See item A5 below.</p>

<h4>A6. CheckLibraryAssembly</h4>

<p class=MsoNormal>For this simple sample, the check code all lives in this one
assembly, so the name of the assembly is specified here.</p>

<h4>A7. CheckStep msTimeLimit</h4>

<p class=MsoNormal>These values determine the timeout for a check step,
including all child steps that run as part of that step.</p>

<p class=MsoNormal>This value is set for any existing check step for a check. If
the check steps change or are initialized at first run of a given check, the
msTimeLimit will default to the value determined by the MetaAutomation
libraries (currently 30,000 milliseconds i.e. 30 seconds).</p>

<p class=MsoNormal>For check steps that do not change as a result of the check
run, the msTimeLimit attribute values will persist to the next check run in the
XML.</p>

<p class=MsoNormal>See entry B3 below for more information on the lifecycle of
the CheckStep elements.</p>

<h4>A8. SubCheckData</h4>

<p class=MsoNormal>This is how a subcheck is defined, i.e. a portion of the
check that would run in a different operating system process. These may be
nested or defined in peer sequence. The CheckMethodGuid (see item A2) defines
what code is run in the new process.</p>

<h3><a name="_Toc516731895">B. Entries that are determined by the check code
and the engine during a check run</a></h3>

<h4>B1. CheckRunGuid</h4>

<p class=MsoNormal>This uniquely describes a run of a check.</p>

<h4>B2. CheckBeginTime and CheckEndTime</h4>

<p class=MsoNormal>These values are determined by the run of the check.</p>

<h4>B3. SubCheckMap</h4>

<p class=MsoNormal>You may ignore this element.</p>

<h4>B4. CheckObjectStorageKey</h4>

<p class=MsoNormal>You may ignore this element.</p>

<h4>B5. CheckStep elements and hierarchy</h4>

<p class=MsoNormal>CheckStep elements describe the step hierarchy of a
repeatable check.</p>

<p class=MsoNormal>Before the first run of a given check, the element
CompleteCheckStepInfo would have no child elements at all. The artifact that
results from the check run will show the CheckStep elements to reflect the
steps of the check, following from the code and other elements of the check.</p>

<p class=MsoNormal>If the steps of a check change, that is detected by the
engine during the first run of the check in which the changed steps occur, and
the new or changed steps are reflected in the artifact of the check run. </p>

<h4>B6. CheckStep Name</h4>

<p class=MsoNormal>The name of the check step is determined by the C# code. The
names are hard-coded and therefore stable and unchanging, the better to support
analysis on the data that is created by the check runs.</p>

<h4>B7. MachineName</h4>

<p class=MsoNormal>This is the machine or tier on which the check step was
executed.</p>

<h4>B8. CheckStep msTimeElapsed</h4>

<p class=MsoNormal>The elapsed time is determined by the check run. The time
includes the running time for all child steps as well.</p>

<h4>B9. CheckStep Value</h4>

<p class=MsoNormal>These values describe the result of a given step in the
check run: Pass, Fail, or Blocked.</p>

<p class=MsoNormal>A result of “Fail” for a given check step propagates up
through ancestor steps.</p>

<p class=MsoNormal>A result of “Blocked” means that the check step was not
executed at all due to an earlier failure.</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc516731896">Troubleshooting</a></h2>

<p class=MsoNormal>Each machine or OS instance that is running the checks must
be able to find all of the other machines. If this isn’t working, the following
checklist might help:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
intra-machine communication fails, check the firewall inbound rules to see if
traffic is blocked for any of the machines for the port number that the local
service install uses.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
intra-machine communication fails, check that DNS allows all of the machines to
find each other. Try “ping” from the command line. If this fails, run “ipconfig
/renew” from the command line on the affected machines.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
intra-machine communication fails, check the firewall outbound rules to ensure
that the traffic is allowed for the port number(s) needed.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>To
simplify the rules and configurations, if port 80 is not needed for anything
else e.g. a web site served by the machines, try standardizing all of the ports
to 80. You could also standardize the ports to 8080 or any other number that is
known to not conflict with other services.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the debugging session continues for more than 10 seconds while the console
window continues to report queries for the results for the process, try forcing
a debugger attach: In project CheckProcess, class CheckProcessMain.cs,
un-comment the 4 lines of code that check Debugger.IsAttached and sleep. Set a
breakpoint a few lines later, at the statement that creates a CheckRunner
object with a new. Rebuild all, then start debug, and attach the debugger to
process CheckProcess.exe.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the check run times out with no informative output to the console, for a debug
build, check the event viewer for the OS instance(s) used. Look for the
“MetaAutomationService” events in the “Applications and Services Logs” group.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the MetaAutomation Sample 3 Visual Studio solution does not load the web
service project, verify that the binding for the local IIS service includes
both “localhost” and the machine name for the web service.</p>

<p class=MsoNormal>You can also ask for help on the LinkedIn group MetaAutomation,
at <span class=MsoHyperlink><a href="https://www.linkedin.com/groups/13563753">https://www.linkedin.com/groups/13563753</a></span>
.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
